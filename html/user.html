<!DOCTYPE html>
<html lang="en">
</head>
<link rel="stylesheet" href="../css/style.css" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

<body>
	<!--Calls the funciton to retrieve the user's current profile picture function-->
	<script type="module">
		import { getUserProfilePicture } from "../js/usersettings-functions.js";
		getUserProfilePicture();
	</script>

	<!--Same as the one from user settings, but with search bar as well-->
	<!--Creates a container defined for the logo and the profile picture-->
	<div class="container-fluid bg-primary">
		<!--Profile Picture and Logo on same row-->
		<div class="row align-items-center justify-content-between no-gutters">
				<!--Diffenrent Columns however, taking up only 4 columns each (bootstrap uses a 12 column system)-->
				<div class="col-4">
					<img src="../img/logo.jpg" class="img-fluid w-50 h-auto float-start" alt="Logo">
				</div>

				<!--Search Bar-->
				<div class="col-4">
					<form class="form-inline">
						<div class="input-group">
							<input type="text" class="form-control" placeholder="Search...">
							<div class="input-group-append">
								<button class="btn btn-outline-light" type="button">Search</button>
							</div>
						</div>
					</form>
				</div>

				<div class="col-4">
					<div class="dropdown">
						<!--Profile Picture will be loaded with getUserProfilePicture function below-->
						<img id="user_profile_picture" class="img-fluid w-25 h-auto float-end rounded-circle" data-bs-toggle="dropdown" alt="Profile Picture">
						<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
							<a class="dropdown-item" href="usersettings.html">Account Settings Page</a>
							<a class="dropdown-item" id="logout">Logout</a>
						</div>
					</div>
				</div>
			</div>
		</div>     
	</div>

	<script src="../js/spelling_correction.js" defer></script>
    	<script>
        	// Function to correct the text in the input field
        	function correctText(inputId) {
            		const input = document.getElementById(inputId);
            		input.value = spelling_correction(input.value);
        	}

        	// Add event listeners to each input field
        	document.addEventListener("DOMContentLoaded", function() {
            		const inputIds = ["class_name", "attribute_name", "type1", "attribute2_name", "type2", "attribute3_name", "type3"];

            		inputIds.forEach(inputId => {
                	const input = document.getElementById(inputId);
                	input.addEventListener("input", function() {
                    		correctText(inputId);
                	});
            	});
        });
    	</script>

	<!-- Zoe White, the navbar allows users to click buttons that have different functions-->
	<div class="navbar">
		<a><button type="button" class="btn btn-primary create-btn" data-bs-toggle="modal" data-bs-target="#createNewDatabaseModal">Create New Database</button></a>
		<a><button type="button" class="btn btn-danger delete-btn" data-bs-toggle="modal" data-bs-target="#delete_database" onclick="delete_database">Delete Database</button></a>
		<a><button class="btn btn-warning edit-btn" onclick="edit_database">Edit Database</button></a>
		<a><button type="button" class="btn btn-success import-btn" data-bs-toggle="modal" data-bs-target="#file_import" onclick="file_import">Import File</button></a>
		<a><button type="button" class="btn btn-info export-btn" data-bs-toggle="modal" data-bs-target="#file_export" onclick="export_file">Export File</button></a>
		<a><button class="btn btn-secondary collaborate-btn" onclick="collaborate">Collaborate</button></a>
	</div>

	<!-- Zoe White, this uses table to have different rows and columns with projects for the user-->
	<div class="row">
		<div class="main2">
			<!--<img src="../img/pi.jpg">-->
			<br>
			<p id="project_name_1">Project 1</p>
			<div id="uml-diagram_1"></div>
		</div>
		<div class="main2">
			<!--<img src="../img/pi.jpg">-->
			<br>
			<p id="project_name_2">Project 2</p>
			<div id="uml-diagram_2"></div>
		</div>	
		<div class="main2">
			<!--<img src="../img/pi.jpg">-->
			<br>
			<p id="project_name_3">Project 3</p>
			<div id="uml-diagram_3"></div>
		</div>	
		<div class="main2">
			<!--<img src="../img/pi.jpg">-->
			<br>
			<p id="project_name_4">Project 4</p>
			<div id="uml-diagram_4"></div>
		</div>	
		<div class="main2">
			<!--<img src="../img/pi.jpg">-->
			<br>
			<p id="project_name_5">Project 5</p>
			<div id="uml-diagram_5"></div>
	</div>
	<!--Dynamically displaying a user's projects-->
	<div class="main2">
		<div class="row">
			<div id="database_project_display_container"></div>
		</div>
	</div>	

	<div class="modal fade" id="createNewDatabaseModal" tabindex="-1" aria-labelledby="createNewDatabaseModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="createNewDatabaseModalLabel">Create New Database</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="main2">
							<input type="text" id="database_project_name" class="form-control mb-3" placeholder="Project Name">
							<div class="container mt-5">
								<div id="database_classes_container"></div>
								<button id="add_class_button" class="btn btn-success">Add Class</button>
							</div>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary" id="create_sql_file">Create SQL File</button>
					<button type="button" class="btn btn-success" id="create_uml_diagram">Create UML</button>
					<button type="button" class="btn btn-info" id="create_new_database_project_button">Generate New Database</button>
				</div>
			</div>
		</div>
	</div>

	<!-- Meraj: The pop-up menu will appear on the screen when a user clicks on the 'Delete Database' buttton -->
	<div class="modal fade" id="delete_database" tabindex="-1" role="dialog" aria-labelledby="delete_database_modal_label" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="delete_database_modal_label">Delete Database</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="main2">
							<div class="img" style="height: 200px;"></div>
							<form class="form">
								<div class="project">
									<label for="existing_project">Choose one of the following projects to delete:</label>
										<select id="existing_project">
											<option value="P1"> Project 1</option>
											<option value="P2">Project 2</option>
											<option value="P3">Project 3</option>
											<option value="P4">Project 4</option>
											<option value="P5">Project 5</option>
										</select>
								</div>
							</form>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary">Delete</button>
				</div>
			</div>
		</div>
	</div>
		
<!-- The pop-up menu will appear on the screen when a user clicks on the 'Delete Database' buttton -->
<div class="modal fade" id="delete_database" tabindex="-1" role="dialog" aria-labelledby="delete_database_modal_label" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="delete_database_modal_label">Delete Database</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="main2">
						<div class="img" style="height: 200px;"></div>
						<form class="form">
							<div class="project">
								<label for="existing_project">Choose one of the following projects to delete:</label>
									<select id="existing_project">
										<option value="P1">Project 1</option>
										<option value="P2">Project 2</option>
										<option value="P3">Project 3</option>
										<option value="P4">Project 4</option>
										<option value="P5">Project 5</option>
									</select>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary">Delete</button>
			</div>
		</div>
	</div>
</div>

<!-- Meraj: A user will click on the Import File button on the user page that takes them to where they want to import an existing SQL file-->
<div class="modal fade" id="file_import" tabindex="-1" role="dialog" aria-labelledby="file_import_modal_label" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="file_import_modal_label">Import File</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="main2">
						<div class="img" style="height: 200px;"></div>

						<!-- Meraj: Set up an event handler for the user to choose an existing file to import from the user's computer -->
						<form class="upload-form" method="post" enctype="multipart/form-data">

							<div class="input-group mb3">
								<label for="file_importing">Import an SQL file</label>
								<input class="form-control" id="file_input" name="file" onchange="" type="file" accept=".sql, .txt, .json" multiple />
							</div>
						</form>
					</div>
				</div>
			</div>

			<!-- Meraj: Once a user imported the file, a user can upload it to parse the document -->
			<div class="modal-footer">
				<button type="submit" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
				<button id="file_import_button" type="submit" class="btn btn-primary">Upload</button>
			</div>
		</div>
	</div>
</div>

<!-- The line in the div section will have the 
	html table outputted filled in with the JSON attributes for the rows and columns -->
<div id="output"> </div>

<div class="modal fade" id="file_export" tabindex="-1" aria-labelledby="file_export_modal_label" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="file_export_modal_label">Export File</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="main2">
						<br>
						<div class="export container">
							<div id="file_export_container"></div>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" id="file_export_button">Export</button>
			</div>
		</div>
	</div>
</div>

 	<!--Creates a new database-->
    <script type="module">
        import { generate_new_database } from "../js/userpage_functions.js";
        generate_new_database()
    </script>

	<!--Creates a new database-->
    <script type="module">
        import { add_database_class } from "../js/userpage_functions.js";
        add_database_class()
    </script>

    <script type="module">
	import { sql_file } from "../js/userpage_functions.js";
	sql_file()
    </script>

    <script type="module">
	import { uml_diagram } from "../js/userpage_functions.js";
	uml_diagram()
    </script>

    <script type="module">
	import { projectName } from "../js/userpage_functions.js";
	projectName()
    </script>

	<!-- Imports a file to parse it -->
	<script type="module">
	import {file_import} from "../js/userpage_functions.js";
	file_import() 
	</script>

	<script type="module">
		import { file_export } from "../js/userpage_functions.js";
		file_export()
	</script>

	<!--Listens to when logout button is pressed, maybe more flexible-->
	<script type="module">
		import { logout } from "../js/loginAccount.js";
		document.getElementById("logout").addEventListener("click", function() {
			// Calls the logout function
			logout();
		});	
	</script>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>
