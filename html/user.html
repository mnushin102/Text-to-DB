<!DOCTYPE html>
<html lang="en">
</head>
<link rel="stylesheet" href="../css/style.css" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

<body>
	<!--Calls the funciton to retrieve the user's current profile picture function-->
	<script type="module">
		import { getUserProfilePicture } from "../js/usersettings-functions.js";
		getUserProfilePicture();
	</script>

	<!--<script src="./create_database.js"></script>-->

	<!--Same as the one from user settings, but with search bar as well-->
	<!--Creates a container defined for the logo and the profile picture-->
	<div class="container-fluid bg-primary">
		<!--Profile Picture and Logo on same row-->
		<div class="row align-items-center justify-content-between no-gutters">
				<!--Diffenrent Columns however, taking up only 4 columns each (bootstrap uses a 12 column system)-->
				<div class="col-4">
					<img src="../img/logo.jpg" class="img-fluid w-50 h-auto float-start" alt="Logo">
				</div>

				<!--Search Bar-->
				<div class="col-4">
					<form class="form-inline">
						<div class="input-group">
							<input type="text" class="form-control" placeholder="Search...">
							<div class="input-group-append">
								<button class="btn btn-outline-light" type="button">Search</button>
							</div>
						</div>
					</form>
				</div>

				<div class="col-4">
					<div class="dropdown">
						<!--Profile Picture will be loaded with getUserProfilePicture function below-->
						<img src="../img/profile_picture.jpg" id="user_profile_picture" class="img-fluid w-25 h-auto float-end rounded-circle" data-bs-toggle="dropdown" alt="Profile Picture">
						<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
							<a class="dropdown-item" href="usersettings.html">Account Settings Page</a>
							<a class="dropdown-item" href="login.html" id="logout">Logout</a>
						</div>
					</div>
				</div>
			</div>
		</div>     
	</div>

	<script src="../js/spelling_correction.js" defer></script>
    	<script>
        	// Function to correct the text in the input field
        	function correctText(inputId) {
            		const input = document.getElementById(inputId);
            		input.value = spelling_correction(input.value);
        	}

        	// Add event listeners to each input field
        	document.addEventListener("DOMContentLoaded", function() {
            		const inputIds = ["class_name", "attribute_name", "type1", "attribute2_name", "type2", "attribute3_name", "type3"];

            		inputIds.forEach(inputId => {
                	const input = document.getElementById(inputId);
                	input.addEventListener("input", function() {
                    		correctText(inputId);
                	});
            	});
        });
    	</script>

	<!-- Zoe White, the navbar allows users to click buttons that have different functions-->
	<div class="navbar">
		<a><button type="button" class="btn btn-primary create-btn" data-bs-toggle="modal" data-bs-target="#createNewDatabaseModal">Create New Database</button></a>
		<a><button type="button" class="btn btn-danger delete-btn" data-bs-toggle="modal" data-bs-target="#delete_database" onclick="delete_database">Delete Database</button></a>
		<a><button class="btn btn-warning edit-btn" onclick="edit_database">Edit Database</button></a>
		<a><button class="btn btn-success import-btn" onclick="import_file">Import File</button></a>
		<a><button class="btn btn-info export-btn" onclick="export_file">Export File</button></a>
		<a><button class="btn btn-secondary collaborate-btn" onclick="collaborate">Collaborate</button></a>
	</div>

	<!-- Zoe White, this uses table to have different rows and columns with projects for the user-->
	<div class="row">
		<div class="main2">
			<!--<img src="../img/pi.jpg">-->
			<br>
			<p>Project 1</p>
			<div id="uml-diagram"></div>
		</div>
		<div class="main2">
			<img src="../img/pi.jpg">
			<br>
			<p>Project 2</p>
		</div>	
		<div class="main2">
			<img src="../img/pi.jpg">
			<br>
			<p>Project 3</p>
		</div>	
		<div class="main2">
			<img src="../img/pi.jpg">
			<br>
			<p>Project 4</p>
		</div>	
		<div class="main2">
			<img src="../img/pi.jpg">
			<br>
			<p>Project 5</p>
	</div>
		
	<div class="modal fade" id="createNewDatabaseModal" tabindex="-1" aria-labelledby="createNewDatabaseModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="createNewDatabaseModalLabel">Create New Database</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="main2">
							<div class="img" style="height:200px;"></div>
							<br>
							<!-- Drop-down menu for choosing Class or Attribute -->
							<select id="element_type">
								<option value="class">Class</option>
								<option value="attribute">Attribute</option>
							</select>
							<!-- Text boxes for naming Class and Attribute -->
							<input type="text" id="class_name" placeholder="Class Name">
							<input type="text" id="attribute_name" placeholder="Attribute Name" disabled>
							<input type="text" id="type1" placeholder="Type 1" disabled>
							<input type="text" id="attribute2_name" placeholder="Attribute 2 Name" disabled>
							<input type="text" id="type2" placeholder="Type 2" disabled>
							<input type="text" id="attribute3_name" placeholder="Attribute 3 Name" disabled>
							<input type="text" id="type3" placeholder="Type 3" disabled>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary" onclick="createNewDatabase()">Create SQL File</button>
					<button type="button" class="btn btn-success" onclick="createUML()">Create UML</button>
				</div>
			</div>
		</div>
	</div>

	<!-- The pop-up menu will appear on the screen when a user clicks on the 'Delete Database' buttton -->
	<div class="modal fade" id="delete_database" tabindex="-1" role="dialog" aria-labelledby="delete_database_modal_label" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title" id="delete_database_modal_label">Delete Database</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
				</div>
				<div class="modal-body">
					<div class="row">
						<div class="main2">
							<div class="img" style="height: 200px;"></div>
							<form class="form">
								<div class="project">
									<label for="existing_project">Choose one of the following projects to delete:</label>
										<select id="existing_project">
											<option value="P1"> Project 1</option>
											<option value="P2">Project 2</option>
											<option value="P3">Project 3</option>
											<option value="P4">Project 4</option>
											<option value="P5">Project 5</option>
										</select>
								</div>
							</form>
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
					<button type="button" class="btn btn-primary">Delete</button>
				</div>
			</div>
		</div>
	</div>

	<script>
	// Function to handle the change in the menu
	document.getElementById("element_type").addEventListener("change", function () {
    		const selectedValue = this.value;
    		const classInput = document.getElementById("class_name");
    		const attributeInput = document.getElementById("attribute_name");
		const attributeInput2 = document.getElementById("attribute2_name");
		const attributeInput3 = document.getElementById("attribute3_name");
		const typeInput = document.getElementById("type1");
		const typeInput2 = document.getElementById("type2");
		const typeInput3 = document.getElementById("type3");

    		// Enable/disable text boxes based on the selected value
    		if (selectedValue === "class") {
        		classInput.disabled = false;
        		attributeInput.disabled = true;
			attributeInput2.disabled = true;
			attributeInput3.disabled = true;
			typeInput.disabled = true;
			typeInput2.disabled = true;
			typeInput3.disabled = true;
    		} else if (selectedValue === "attribute") {
        		classInput.disabled = true;
        		attributeInput.disabled = false;
			attributeInput2.disabled = false;
			attributeInput3.disabled = false;
			typeInput.disabled = false;
			typeInput2.disabled = false;
			typeInput3.disabled = false;
    		}
	});

	// Function to create UML diagram
	function createUML() {
    		const elementType = document.getElementById("element_type").value;
    		const className = document.getElementById("class_name").value;
    		const attributeName = document.getElementById("attribute_name").value;
    		const attribute2Name = document.getElementById("attribute2_name").value;
    		const attribute3Name = document.getElementById("attribute3_name").value;
		const type1 = document.getElementById("type1").value;
    		const type2 = document.getElementById("type2").value;
    		const type3 = document.getElementById("type3").value;

     		// Calculate the center coordinates of the rectangles
		const classRectX = 10;
    		const classRectY = 10;
    		const attrRectX = 10;
    		const attrRectY = 40;

    		// Construct the SVG code for the UML diagram
    		const umlDiagram = `
        	<svg width="300" height="200">
            		<!-- Draw rectangle for class -->
            		<rect x="${classRectX}" y="${classRectY}" width="150" height="30" fill="#f0f0f0" stroke="#000000" stroke-width="1"/>
            		<!-- Class name -->
            		<text x="${classRectX + 75}" y="${classRectY + 22}" font-family="Arial" font-size="14" text-anchor="middle" alignment-baseline="middle">${className}</text>
            		<!-- Draw rectangle for attributes -->
            		<rect x="${attrRectX}" y="${attrRectY}" width="150" height="90" fill="#f0f0f0" stroke="#000000" stroke-width="1"/>
            		<!-- Attribute 1 -->
            		<text x="${attrRectX + 10}" y="${attrRectY + 20}" font-family="Arial" font-size="12" alignment-baseline="middle">+ ${attributeName} : ${type1}</text>
            		<!-- Attribute 2 -->
            		<text x="${attrRectX + 10}" y="${attrRectY + 45}" font-family="Arial" font-size="12" alignment-baseline="middle">+ ${attribute2Name} : ${type2}</text>
            		<!-- Attribute 3 -->
            		<text x="${attrRectX + 10}" y="${attrRectY + 70}" font-family="Arial" font-size="12" alignment-baseline="middle">+ ${attribute3Name} : ${type3}</text>
        	</svg>
    		`;

    		// Get the uml-diagram div and insert the SVG code
    		const umlDiagramDiv = document.getElementById("uml-diagram");
		
    		if (umlDiagramDiv) {
        		umlDiagramDiv.innerHTML = umlDiagram;
    			}
		}
	</script>
		
<!-- The pop-up menu will appear on the screen when a user clicks on the 'Delete Database' buttton -->
<div class="modal fade" id="delete_database" tabindex="-1" role="dialog" aria-labelledby="delete_database_modal_label" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="delete_database_modal_label">Delete Database</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="main2">
						<div class="img" style="height: 200px;"></div>
						<form class="form">
							<div class="project">
								<label for="existing_project">Choose one of the following projects to delete:</label>
									<select id="existing_project">
										<option value="P1">Project 1</option>
										<option value="P2">Project 2</option>
										<option value="P3">Project 3</option>
										<option value="P4">Project 4</option>
										<option value="P5">Project 5</option>
									</select>
							</div>
						</form>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary">Delete</button>
			</div>
		</div>
	</div>
</div>

	<script>
		function createNewDatabase() {
			const attribute1 = document.getElementById("project1_attribute1").value;
			const attribute2 = document.getElementById("project1_attribute2").value;
			const attributeName1 = document.getElementById("project1_attributeName1").value;
			const attributeName2 = document.getElementById("project1_attributeName2").value;

			const attributes = [
				{ name: attributeName1, type: convertAttributeToSQLType(attribute1) },
				{ name: attributeName2, type: convertAttributeToSQLType(attribute2) }
			];

			createNewDatabase(attributes);
		}

		function convertAttributeToSQLType(attributeOption) {
			switch (attributeOption) {
				case "attribute1_option1":
					return "VARCHAR(200)";
				case "attribute1_option2":
					return "INT";
				default:
					return "VARCHAR(200)";
			}
		}		
	</script>



	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>
